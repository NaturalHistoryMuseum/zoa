{"version":3,"file":"Multiselect-8bd7a645.js","sources":["../../node_modules/levenshtein-search/utils.js","../../node_modules/levenshtein-search/levenshtein-search.js","../../node_modules/levenshtein-search/index.js","../../src/components/inputs/dropdown/Multiselect.vue"],"sourcesContent":["function * searchExact (needle, haystack, startIndex = 0, endIndex = null) {\n  const needleLen = needle.length\n  if (needleLen === 0) return\n\n  if (endIndex === null) {\n    endIndex = haystack.length\n  }\n  let index\n\n  while ((index = haystack.indexOf(needle, startIndex)) > -1) {\n    if (index + needle.length > endIndex) break\n    yield index\n    startIndex = index + 1\n  }\n}\n\nfunction reverse (string) {\n  return string\n    .split('')\n    .reverse()\n    .join('')\n}\n\nmodule.exports = {\n  searchExact,\n  reverse\n}\n","const { searchExact, reverse } = require('./utils')\n\nfunction isEditDistanceNoGreaterThan (a, b, maxDist) {\n  if (a.length > b.length) {\n    [a, b] = [b, a]\n  }\n  const lenDelta = b.length - a.length\n  if (lenDelta > maxDist) {\n    return false\n  }\n\n  if (maxDist === 0) {\n    return a === b\n  }\n\n  let firstDiffIdx\n  for (firstDiffIdx = 0; firstDiffIdx < a.length; firstDiffIdx++) {\n    if (a[firstDiffIdx] !== b[firstDiffIdx]) break\n  }\n  if (firstDiffIdx === a.length) {\n    return lenDelta <= maxDist\n  }\n\n  let lastDiffIdx\n  for (lastDiffIdx = a.length - 1; lastDiffIdx >= 0; lastDiffIdx--) {\n    if (a[lastDiffIdx] !== b[lastDiffIdx + lenDelta]) break\n  }\n\n  a = a.slice(firstDiffIdx, lastDiffIdx + 1)\n  b = b.slice(firstDiffIdx, lastDiffIdx + 1 + lenDelta)\n\n  const [dist, length] = _expand(a, b, maxDist)\n  return dist + (b.length - length) <= maxDist\n}\n\nfunction editDistance (a, b) {\n  if (a.length > b.length) {\n    [a, b] = [b, a]\n  }\n  const scores = new Array(a.length + 1)\n  for (let i = 0; i <= a.length; i++) {\n    scores[i] = i\n  }\n\n  let _prevScore\n  let prevScore\n  for (let i = 0; i < b.length; i++) {\n    scores[0] = i + 1\n    prevScore = i\n    for (let k = 0; k < a.length; k++) {\n      _prevScore = scores[k + 1]\n      scores[k + 1] = Math.min(\n        prevScore + +(a[k] !== b[i]),\n        scores[k] + 1,\n        scores[k + 1] + 1\n      )\n      prevScore = _prevScore\n    }\n  }\n\n  return scores[a.length]\n}\n\nfunction makeChar2needleIdx (needle, maxDist) {\n  const res = {}\n  for (let i = Math.min(needle.length - 1, maxDist); i >= 0; i--) {\n    res[needle[i]] = i\n  }\n  return res\n}\n\nfunction * fuzzySearch (needle, haystack, maxDist) {\n  if (needle.length > haystack.length + maxDist) return\n\n  const ngramLen = Math.floor(needle.length / (maxDist + 1))\n\n  if (maxDist === 0) {\n    for (const index of searchExact(needle, haystack)) {\n      yield {\n        start: index,\n        end: index + needle.length,\n        dist: 0\n      }\n    }\n  } else if (ngramLen >= 10) {\n    yield * fuzzySearchNgrams(needle, haystack, maxDist)\n  } else {\n    yield * fuzzySearchCandidates(needle, haystack, maxDist)\n  }\n}\n\nfunction _expand (needle, haystack, maxDist) {\n  maxDist = +maxDist\n\n  let firstDiff\n  for (firstDiff = 0; firstDiff < Math.min(needle.length, haystack.length); firstDiff++) {\n    if (needle.charCodeAt(firstDiff) !== haystack.charCodeAt(firstDiff)) break\n  }\n  if (firstDiff) {\n    needle = needle.slice(firstDiff)\n    haystack = haystack.slice(firstDiff)\n  }\n\n  if (!needle) {\n    return [0, firstDiff]\n  } else if (!haystack) {\n    if (needle.length <= maxDist) {\n      return [needle.length, firstDiff]\n    } else {\n      return [null, null]\n    }\n  }\n\n  if (maxDist === 0) return [null, null]\n\n  let scores = new Array(needle.length + 1)\n  for (let i = 0; i <= maxDist; i++) {\n    scores[i] = i\n  }\n  let newScores = new Array(needle.length + 1)\n\n  let minScore = null\n  let minScoreIdx = null\n  let maxGoodScore = maxDist\n  let firstGoodScoreIdx = 0\n  let lastGoodScoreIdx = needle.length - 1\n\n  for (let haystackIdx = 0; haystackIdx < haystack.length; haystackIdx++) {\n    const char = haystack.charCodeAt(haystackIdx)\n\n    const needleIdxStart = Math.max(0, firstGoodScoreIdx - 1)\n    const needleIdxLimit = Math.min(\n      haystackIdx + maxDist,\n      needle.length - 1,\n      lastGoodScoreIdx\n    )\n\n    newScores[0] = scores[0] + 1\n    firstGoodScoreIdx = newScores[0] <= maxGoodScore ? 0 : null\n    lastGoodScoreIdx = newScores[0] <= maxGoodScore ? 0 : -1\n\n    let needleIdx\n    for (needleIdx = needleIdxStart; needleIdx < needleIdxLimit; needleIdx++) {\n      const score = newScores[needleIdx + 1] = Math.min(\n        scores[needleIdx] + +(char !== needle.charCodeAt(needleIdx)),\n        scores[needleIdx + 1] + 1,\n        newScores[needleIdx] + 1\n      )\n      if (score <= maxGoodScore) {\n        if (firstGoodScoreIdx === null) firstGoodScoreIdx = needleIdx + 1\n        lastGoodScoreIdx = Math.max(\n          lastGoodScoreIdx,\n          needleIdx + 1 + (maxGoodScore - score)\n        )\n      }\n    }\n\n    const lastScore = newScores[needleIdx + 1] = Math.min(\n      scores[needleIdx] + +(char !== needle.charCodeAt(needleIdx)),\n      newScores[needleIdx] + 1\n    )\n    if (lastScore <= maxGoodScore) {\n      if (firstGoodScoreIdx === null) firstGoodScoreIdx = needleIdx + 1\n      lastGoodScoreIdx = needleIdx + 1\n    }\n\n    if (\n      needleIdx === needle.length - 1 &&\n      (minScore === null || lastScore <= minScore)\n    ) {\n      minScore = lastScore\n      minScoreIdx = haystackIdx\n      if (minScore < maxGoodScore) maxGoodScore = minScore\n    }\n\n    [scores, newScores] = [newScores, scores]\n\n    if (firstGoodScoreIdx === null) break\n  }\n\n  if (minScore !== null && minScore <= maxDist) {\n    return [minScore, minScoreIdx + 1 + firstDiff]\n  } else {\n    return [null, null]\n  }\n}\n\nfunction * fuzzySearchNgrams (needle, haystack, maxDist) {\n  // use n-gram search\n  const ngramLen = Math.floor(needle.length / (maxDist + 1))\n  const needleLen = needle.length\n  const haystackLen = haystack.length\n  for (let ngramStartIdx = 0;\n    ngramStartIdx <= needle.length - ngramLen;\n    ngramStartIdx += ngramLen\n  ) {\n    const ngram = needle.slice(ngramStartIdx, ngramStartIdx + ngramLen)\n\n    const ngramEnd = ngramStartIdx + ngramLen\n    const needleBeforeReversed = reverse(needle.slice(0, ngramStartIdx))\n    const needleAfter = needle.slice(ngramEnd)\n    const startIdx = Math.max(0, ngramStartIdx - maxDist)\n    const endIdx = Math.min(haystackLen, haystackLen - needleLen + ngramEnd + maxDist)\n\n    for (const haystackMatchIdx of searchExact(ngram, haystack, startIdx, endIdx)) {\n      // try to expand left\n      const [distRight, rightExpandSize] = _expand(\n        needleAfter,\n        haystack.slice(\n          haystackMatchIdx + ngramLen,\n          haystackMatchIdx - ngramStartIdx + needleLen + maxDist\n        ),\n        maxDist\n      )\n      if (distRight === null) continue\n\n      const [distLeft, leftExpandSize] = _expand(\n        needleBeforeReversed,\n        reverse(haystack.slice(\n          Math.max(0, haystackMatchIdx - ngramStartIdx - (maxDist - distRight)),\n          haystackMatchIdx\n        )),\n        maxDist - distRight\n      )\n      if (distLeft === null) continue\n\n      yield {\n        start: haystackMatchIdx - leftExpandSize,\n        end: haystackMatchIdx + ngramLen + rightExpandSize,\n        dist: distLeft + distRight\n      }\n    }\n  }\n}\n\nfunction * fuzzySearchCandidates (needle, haystack, maxDist) {\n  const debugFlag = false\n  if (debugFlag) console.log(`fuzzySearchCandidates(${needle}, ${haystack}, ${maxDist})`)\n\n  // prepare some often used things in advance\n  const needleLen = needle.length\n  const haystackLen = haystack.length\n  if (needleLen > haystackLen + maxDist) return\n  const char2needleIdx = makeChar2needleIdx(needle, maxDist)\n\n  let prevCandidates = [] // candidates from the last iteration\n  let candidates = [] // new candidates from the current iteration\n\n  // iterate over the chars in the haystack, updating the candidates for each\n  for (let i = 0; i < haystack.length; i++) {\n    const haystackChar = haystack[i]\n\n    prevCandidates = candidates\n    candidates = []\n\n    const needleIdx = char2needleIdx[haystackChar]\n    if (needleIdx !== undefined) {\n      if (needleIdx + 1 === needleLen) {\n        if (debugFlag) {\n          console.log(`yield ${{\n            start: i,\n            end: i + 1,\n            dist: needleIdx\n          }}`)\n        }\n        yield {\n          start: i,\n          end: i + 1,\n          dist: needleIdx\n        }\n      } else {\n        candidates.push({\n          startIdx: i,\n          needleIdx: needleIdx + 1,\n          dist: needleIdx\n        })\n      }\n    }\n\n    for (const candidate of prevCandidates) {\n      // if this sequence char is the candidate's next expected char\n      if (needle[candidate.needleIdx] === haystackChar) {\n        // if reached the end of the needle, return a match\n        if (candidate.needleIdx + 1 === needleLen) {\n          if (debugFlag) {\n            console.log(`yield ${{\n              start: candidate.startIdx,\n              end: i + 1,\n              dist: candidate.dist\n            }}`)\n          }\n          yield {\n            start: candidate.startIdx,\n            end: i + 1,\n            dist: candidate.dist\n          }\n        } else {\n          // otherwise, update the candidate's needleIdx and keep it\n          candidates.push({\n            startIdx: candidate.startIdx,\n            needleIdx: candidate.needleIdx + 1,\n            dist: candidate.dist\n          })\n        }\n      } else {\n        if (candidate.dist === maxDist) continue\n\n        candidates.push({\n          startIdx: candidate.startIdx,\n          needleIdx: candidate.needleIdx,\n          dist: candidate.dist + 1\n        })\n\n        for (let nSkipped = 1; nSkipped <= maxDist - candidate.dist; nSkipped++) {\n          if (candidate.needleIdx + nSkipped === needleLen) {\n            if (debugFlag) {\n              console.log(`yield ${{\n                start: candidate.startIdx,\n                end: i + 1,\n                dist: candidate.dist + nSkipped\n              }}`)\n            }\n            yield {\n              start: candidate.startIdx,\n              end: i + 1,\n              dist: candidate.dist + nSkipped\n            }\n            break\n          } else if (needle[candidate.needleIdx + nSkipped] === haystackChar) {\n            if (candidate.needleIdx + nSkipped + 1 === needleLen) {\n              if (debugFlag) {\n                console.log(`yield ${{\n                  start: candidate.startIdx,\n                  end: i + 1,\n                  dist: candidate.dist + nSkipped\n                }}`)\n              }\n              yield {\n                start: candidate.startIdx,\n                end: i + 1,\n                dist: candidate.dist + nSkipped\n              }\n            } else {\n              candidates.push({\n                startIdx: candidate.startIdx,\n                needleIdx: candidate.needleIdx + 1 + nSkipped,\n                dist: candidate.dist + nSkipped\n              })\n            }\n            break\n          }\n        }\n\n        if (i + 1 < haystackLen && candidate.needleIdx + 1 < needleLen) {\n          candidates.push({\n            startIdx: candidate.startIdx,\n            needleIdx: candidate.needleIdx + 1,\n            dist: candidate.dist + 1\n          })\n        }\n      }\n    }\n\n    if (debugFlag) console.log(candidates)\n  }\n\n  for (const candidate of candidates) {\n    candidate.dist += needle.length - candidate.needleIdx\n    if (candidate.dist <= maxDist) {\n      yield {\n        start: candidate.startIdx,\n        end: haystack.length,\n        dist: candidate.dist\n      }\n    }\n  }\n}\n\nmodule.exports = {\n  _expand,\n  editDistance,\n  fuzzySearch,\n  fuzzySearchNgrams,\n  fuzzySearchCandidates,\n  isEditDistanceNoGreaterThan\n}\n","const { editDistance, fuzzySearch, isEditDistanceNoGreaterThan } =\n  require('./levenshtein-search')\n\nmodule.exports = {\n  editDistance,\n  fuzzySearch,\n  isEditDistanceNoGreaterThan\n}\n","<template>\n  <div\n    :class=\"[$style.grid, $style[`grid--${labelPosition}`]]\"\n    :id=\"componentId\"\n  >\n    <label\n      :for=\"subId('textbox')\"\n      v-if=\"label && labelPosition !== 'none'\"\n      :class=\"[$style.label, $style[`label--${labelPosition}`]]\"\n    >\n      {{ label }}\n    </label>\n    <div :class=\"$style.wrapper\" ref=\"container\">\n      <div :class=\"$style.textboxWrapper\">\n        <input\n          type=\"text\"\n          :placeholder=\"placeholder\"\n          :id=\"subId('search')\"\n          :class=\"$style.input\"\n          v-model=\"search\"\n          v-show=\"focused\"\n          ref=\"textbox\"\n        />\n        <div\n          :class=\"$style.input\"\n          tabindex=\"0\"\n          v-show=\"!focused\"\n          @focusin=\"startFocus\"\n        >\n          {{ value ? value.length : 0 }} {{ itemString }} selected\n        </div>\n        <font-awesome-icon\n          icon=\"fa-solid fa-caret-down\"\n          :class=\"$style.arrow\"\n          @click=\"toggleFocus\"\n        />\n      </div>\n      <div :class=\"$style.options\" v-if=\"focused\" ref=\"dropdown\">\n        <ul v-if=\"allOptions.length > 0\" :class=\"$style.optlist\">\n          <li\n            title=\"Select all\"\n            :class=\"[$style.selectAll, $style.listItem, $style.option]\"\n            :style=\"{ height: `${itemHeight}px` }\"\n          >\n            <ZoaCheckbox\n              label=\"Select all\"\n              label-position=\"right\"\n              v-model=\"selectAll\"\n            />\n          </li>\n          <li\n            title=\"Select results\"\n            :class=\"[$style.selectAll, $style.listItem, $style.option]\"\n            :style=\"{ height: `${itemHeight}px` }\"\n            v-if=\"!!_search\"\n          >\n            <ZoaCheckbox\n              label=\"Select results\"\n              label-position=\"right\"\n              v-model=\"selectFiltered\"\n            />\n          </li>\n          <li\n            v-for=\"item in filteredItems\"\n            :title=\"item.label\"\n            :class=\"[\n              $style.listItem,\n              item.kind === 'group' ? $style.subgroup : $style.option,\n            ]\"\n            :style=\"{ height: `${itemHeight}px` }\"\n          >\n            <div @click=\"selectGroup(item.group)\" v-if=\"item.kind === 'group'\">\n              {{ item.label }}\n            </div>\n            <div v-else>\n              <ZoaCheckbox\n                :label=\"item.label\"\n                label-position=\"right\"\n                :check-value=\"item.value\"\n                :name=\"subId('checkboxes')\"\n                v-model=\"value\"\n                v-if=\"item.ix >= lowerVisible && item.ix <= upperVisible\"\n              />\n            </div>\n          </li>\n        </ul>\n        <div :class=\"$style.noOptions\" v-else>No options found</div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { useComponentId } from '../../utils/compid.js';\nimport { useChangeEmits } from '../common.js';\nimport { computed, ref, watch } from 'vue';\nimport {\n  onClickOutside,\n  onKeyStroke,\n  useFocusWithin,\n  useFocus,\n  useScroll,\n} from '@vueuse/core';\nimport FontAwesomeIcon from '../../../icons.js';\nimport ZoaCheckbox from '../checkbox/Checkbox.vue';\nimport { debounce } from 'dettle';\nimport { fuzzySearch } from 'levenshtein-search';\n\nconst props = defineProps({\n  /**\n   * @model\n   */\n  modelValue: {\n    type: Array,\n  },\n  /**\n   * Text for the input label.\n   */\n  label: {\n    type: String,\n    default: 'Multiselect',\n  },\n  /**\n   * Position of the input label (or none).\n   * @values left, right, above, below, none\n   */\n  labelPosition: {\n    type: String,\n    default: 'above',\n  },\n  /**\n   * Debounce delay for the `change` event, in ms.\n   */\n  delay: {\n    type: Number,\n    default: 0,\n  },\n  /**\n   * Text to display in the blank input.\n   */\n  placeholder: {\n    type: [String, undefined],\n    default: null,\n  },\n  /**\n   * The options available to select. Each item can be a string, or an object with `label` and `value` keys.\n   */\n  options: {\n    type: Array,\n  },\n  /**\n   * The string used to describe the items being selected, in singular form e.g. \"resource\", \"genus\".\n   */\n  itemName: {\n    type: String,\n    default: 'item',\n  },\n  /**\n   * The plural form of itemName, e.g. \"resources\", \"genera\". If null (default), an \"s\" will be added to itemName.\n   */\n  itemNamePlural: {\n    type: [String, null],\n    default: null,\n  },\n  /**\n   * Debounce delay for the `search` event, in ms.\n   */\n  searchDelay: {\n    type: Number,\n    default: 200,\n  },\n  /**\n   * Enables an internal list filtering based on the search value. Disable if implementing an external filter using the emit.\n   */\n  enableSearch: {\n    type: Boolean,\n    default: false,\n  },\n  /**\n   * Override the height (in px) of each list item. May be necessary if font family or size is changed from the default.\n   */\n  itemHeight: {\n    type: Number,\n    default: 38,\n  },\n});\n\nconst { componentId, subId } = useComponentId();\n\nconst emit = defineEmits([\n  /**\n   * Emitted when the value changes; debounced if the delay prop is > 0.\n   * @arg {string} newValue the new value\n   */\n  'change',\n  /**\n   * @ignore\n   */\n  'update:modelValue',\n  /**\n   * Emitted when the search value changes; debounced if the searchDelay prop is > 0.\n   * @arg {string} searchTerm the search term\n   */\n  'search',\n]);\nconst { value } = useChangeEmits(emit, props);\nif (!Array.isArray(value)) {\n  // needs to be initialised as an array or the checkboxes will all select as\n  // one, but returning an empty array as the default prop breaks reactivity\n  value.value = [];\n}\n\n// searching\nconst _search = ref(null);\nconst emitSearch = debounce((searchTerm) => {\n  emit('search', searchTerm);\n}, props.searchDelay);\nconst updateSearch = debounce((searchTerm) => {\n  _search.value = searchTerm;\n}, props.searchDelay);\nconst search = computed({\n  get() {\n    return _search.value;\n  },\n  set(searchTerm) {\n    updateSearch(searchTerm);\n    emitSearch(searchTerm);\n  },\n});\n\n// processed props\nconst itemString = computed(() => {\n  const isPlural = value.value ? value.value.length !== 1 : true;\n  if (isPlural) {\n    return props.itemNamePlural || props.itemName + 's';\n  }\n  return props.itemName;\n});\n\nconst allOptions = computed(() => {\n  let outputOptions = [];\n  props.options.forEach((o) => {\n    if (typeof o === 'object') {\n      outputOptions.push({\n        label: o.label || o.value,\n        value: o.value || o.label,\n        group: o.group || null,\n        order: o.order || null,\n      });\n    } else {\n      outputOptions.push({ label: o, value: o, group: null });\n    }\n  });\n  outputOptions.sort((a, b) => {\n    let groupSort;\n    if (a.group === b.group) {\n      groupSort = 0;\n    } else if (!a.group || !b.group) {\n      groupSort = !a.group ? -1 : 1;\n    } else {\n      groupSort = a.group.localeCompare(b.group);\n    }\n\n    let orderSort = 0;\n    if (a.order || b.order) {\n      orderSort = a.order && b.order ? a.order - b.order : a.order ? 1 : -1;\n    }\n\n    let labelSort = a.label.localeCompare(b.label);\n\n    return groupSort !== 0\n      ? groupSort\n      : orderSort !== 0\n      ? orderSort\n      : labelSort;\n  });\n  return outputOptions;\n});\n\nconst filteredItems = computed(() => {\n  const doSearch = props.enableSearch && search.value;\n  const searchString = doSearch ? search.value.toLowerCase() : null;\n  const checkMatch = (txt) => {\n    return txt\n      ? [...fuzzySearch(searchString, txt.toLowerCase(), 1)].length > 0\n      : false;\n  };\n\n  let filteredOptions;\n  if (doSearch) {\n    filteredOptions = allOptions.value.filter((o) => {\n      return checkMatch(o.group) || checkMatch(o.label) || checkMatch(o.value);\n    });\n  } else {\n    filteredOptions = allOptions.value;\n  }\n\n  let items = [];\n  let grouped = Object.entries(\n    Object.groupBy(filteredOptions, ({ group }) => group),\n  );\n  let ix = searchString ? 2 : 1; // skip the multiselect checkboxes\n  grouped.forEach((g) => {\n    let groupName = g[0];\n    let groupOptions = g[1];\n    if (groupName && groupName !== 'null') {\n      items.push({\n        ix: ix,\n        kind: 'group',\n        label: groupName,\n        value: groupName,\n        group: groupName,\n      });\n      ix += 1;\n    }\n    items = items.concat(\n      groupOptions.map((o, i) => {\n        return {\n          ix: ix + i,\n          kind: 'option',\n          label: o.label,\n          value: o.value,\n          group: o.group,\n        };\n      }),\n    );\n    ix += groupOptions.length;\n  });\n  return items;\n});\n\n// elements\nconst container = ref(null);\nconst textbox = ref(null);\nconst dropdown = ref(null);\n\n// scrolling\nconst { y } = useScroll(dropdown);\nconst scrollY = computed(() => {\n  // y from useScroll doesn't reset when the dropdown element is reloaded until\n  // the user starts scrolling, which is obviously not ideal. Using scrollTop\n  // alone/directly doesn't update quickly/often enough, so we have to combine.\n  if (\n    !dropdown.value ||\n    (dropdown.value && y.value !== dropdown.value.scrollTop)\n  ) {\n    return 0;\n  }\n  return y.value;\n});\nconst buffer = 10; // how many items either side of the visible items should be loaded\nconst dropdownHeight = computed(() => {\n  try {\n    return dropdown.value.clientHeight;\n  } catch {\n    return 500;\n  }\n});\nconst lowerVisible = computed(() => {\n  // doesn't matter if it's < n options\n  return Math.floor(scrollY.value / props.itemHeight) - buffer;\n});\nconst upperVisible = computed(() => {\n  // doesn't matter if it's > n options\n  return Math.ceil((scrollY.value + dropdownHeight.value) / props.itemHeight);\n});\n\n// focus and keyboard navigation\nconst focused = ref(false);\nconst textboxFocus = useFocus(textbox);\nconst dropdownFocus = useFocusWithin(dropdown);\n\nfunction startFocus() {\n  focused.value = true;\n  setTimeout(() => {\n    textbox.value.focus();\n  }, 50);\n}\n\nfunction unfocus() {\n  try {\n    container.value.blur();\n    textbox.value.blur();\n    dropdown.value.blur();\n  } catch {\n    // doesn't really matter\n  }\n  focused.value = false;\n}\n\nfunction toggleFocus() {\n  focused.value ? unfocus() : startFocus();\n}\n\nonClickOutside(container, () => {\n  unfocus();\n});\n\nonKeyStroke('ArrowDown', () => {\n  if (allOptions.value.length === 0) {\n    return;\n  }\n  if (textboxFocus.focused.value) {\n    dropdown.value.children[0].children[0].children[0].focus();\n  } else if (dropdownFocus.focused.value) {\n    const labels = [...dropdown.value.querySelectorAll('label')];\n    const selectedElement = dropdown.value.querySelector('label:focus');\n    if (!selectedElement) {\n      labels[0].focus();\n    } else {\n      const ix = labels.findIndex((lbl) => lbl === selectedElement);\n      if (ix === labels.length - 1) {\n        labels[0].focus();\n      } else {\n        labels[ix + 1].focus();\n      }\n    }\n  }\n});\n\nonKeyStroke('ArrowUp', () => {\n  if (allOptions.value.length === 0) {\n    return;\n  }\n  if (dropdownFocus.focused.value) {\n    const labels = [...dropdown.value.querySelectorAll('label')];\n    const selectedElement = dropdown.value.querySelector('label:focus');\n    if (!selectedElement) {\n      textbox.value.focus();\n    } else {\n      const ix = labels.findIndex((lbl) => lbl === selectedElement);\n      if (ix === 0) {\n        textbox.value.focus();\n      } else {\n        labels[ix - 1].focus();\n      }\n    }\n  }\n});\n\nonKeyStroke('Enter', () => {\n  unfocus();\n});\n\n// select/deselect multiple checkboxes at once\n/**\n * On checking, selects all options (the full unfiltered list).\n */\nconst selectAll = computed({\n  get() {\n    const options = allOptions.value;\n    if (value.value.length !== options.length) {\n      return false;\n    }\n    const unchecked = options.filter((o) => !value.value.includes(o.value));\n    return unchecked.length === 0;\n  },\n  set(toggleValue) {\n    if (toggleValue) {\n      value.value = allOptions.value.map((o) => o.value);\n    } else {\n      value.value = [];\n    }\n  },\n});\n\n/**\n * On checking, selects all FILTERED options.\n */\nconst selectFiltered = computed({\n  get() {\n    let options = filteredItems.value\n      .filter((i) => i.kind === 'option')\n      .map((o) => o.value);\n    if (value.value.length < options.length) {\n      return false;\n    }\n    const unchecked = options.filter((o) => !value.value.includes(o));\n    return unchecked.length === 0;\n  },\n  set(toggleValue) {\n    let options = filteredItems.value\n      .filter((i) => i.kind === 'option')\n      .map((o) => o.value);\n    if (toggleValue) {\n      const unchecked = options.filter((o) => !value.value.includes(o));\n      value.value = value.value.concat(unchecked);\n    } else {\n      value.value = value.value.filter((o) => !options.includes(o));\n    }\n  },\n});\n\n/**\n * Selects all FILTERED group options.\n * @param groupName\n */\nfunction selectGroup(groupName) {\n  const group = filteredItems.value\n    .filter((o) => o.kind === 'option' && o.group === groupName)\n    .map((o) => o.value);\n  const unchecked = group.filter((o) => !value.value.includes(o));\n  if (unchecked.length > 0) {\n    unchecked.forEach((o) => {\n      value.value.push(o);\n    });\n  } else {\n    value.value = value.value.filter((o) => !group.includes(o));\n  }\n}\n</script>\n\n<style module lang=\"scss\">\n@import '../inputs';\n\n.wrapper {\n  position: relative;\n}\n\n.options {\n  position: absolute;\n  background: white;\n  border: 1px solid $grey;\n  border-radius: $rounding;\n  width: 100%;\n  margin-top: 2px;\n  font-size: 0.9em;\n  max-height: 500px;\n  overflow-y: scroll;\n  overflow-x: hidden;\n}\n\nul.optlist {\n  padding: 0;\n  margin: 0;\n  list-style: none;\n}\n\n.listItem {\n  cursor: pointer;\n\n  &:first-child {\n    border-radius: $rounding $rounding 0 0;\n  }\n\n  &:last-child {\n    border-radius: 0 0 $rounding $rounding;\n  }\n\n  & > * {\n    padding: $padding;\n    cursor: pointer;\n  }\n\n  &.option {\n    &:not(.selectAll) > * {\n      &:hover,\n      &:focus {\n        background: $secondary;\n      }\n    }\n\n    & label {\n      height: 100%;\n    }\n  }\n\n  &.option label > span:first-child,\n  &.subgroup > div {\n    width: 100%;\n    overflow-x: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n}\n\n.selectAll + .option:not(.selectAll) {\n  border-top: 2px solid $primary;\n}\n\n.subgroup {\n  border-top: 2px solid $primary;\n\n  & > .optlist label {\n    padding-left: calc($h-pad * 2);\n  }\n}\n\n.selectAll > *,\n.subgroup > *:first-child {\n  &:hover,\n  &:focus {\n    background: $primary;\n  }\n}\n\n.noOptions {\n  font-size: 0.8em;\n  font-style: italic;\n  padding: $padding;\n  opacity: 0.8;\n}\n\n.textboxWrapper {\n  position: relative;\n\n  & > .arrow {\n    position: absolute;\n    top: 0;\n    right: 1em;\n    bottom: 0;\n    margin: auto;\n    padding-left: 1em;\n    cursor: pointer;\n  }\n}\n</style>\n"],"names":["searchExact","needle","haystack","startIndex","endIndex","index","reverse","string","utils","require$$0","isEditDistanceNoGreaterThan","a","b","maxDist","lenDelta","firstDiffIdx","lastDiffIdx","dist","length","_expand","editDistance","scores","i","_prevScore","prevScore","k","makeChar2needleIdx","res","fuzzySearch","ngramLen","fuzzySearchNgrams","fuzzySearchCandidates","firstDiff","newScores","minScore","minScoreIdx","maxGoodScore","firstGoodScoreIdx","lastGoodScoreIdx","haystackIdx","char","needleIdxStart","needleIdxLimit","needleIdx","score","lastScore","needleLen","haystackLen","ngramStartIdx","ngram","ngramEnd","needleBeforeReversed","needleAfter","startIdx","endIdx","haystackMatchIdx","distRight","rightExpandSize","distLeft","leftExpandSize","char2needleIdx","prevCandidates","candidates","haystackChar","candidate","nSkipped","levenshteinSearch","buffer","componentId","subId","useComponentId","value","useChangeEmits","emit","props","_search","ref","emitSearch","debounce","searchTerm","updateSearch","search","computed","itemString","allOptions","outputOptions","o","groupSort","orderSort","labelSort","filteredItems","doSearch","searchString","checkMatch","txt","filteredOptions","items","grouped","group","ix","g","groupName","groupOptions","container","textbox","dropdown","y","useScroll","scrollY","dropdownHeight","lowerVisible","upperVisible","focused","textboxFocus","useFocus","dropdownFocus","useFocusWithin","startFocus","unfocus","toggleFocus","onClickOutside","onKeyStroke","labels","selectedElement","lbl","selectAll","options","toggleValue","selectFiltered","unchecked","selectGroup"],"mappings":"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","x_google_ignoreList":[0,1,2]}