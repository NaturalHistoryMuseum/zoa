import{b as C,p as x,o as S,d as w,u as $,n as y,t as F,k as O,f as N,w as Y,v as ce,L as X,e as B,x as G,F as de,q as fe,I as pe,l as he}from"./vue.esm-bundler-322ccd87.js";import{u as ge,a as ve,d as J}from"./common-880f5067.js";import{c as me,u as be,a as ye,o as _e,b as W}from"./index-8677b196.js";import{F as Ie}from"./icons-b305d7ce.js";import{Z as j}from"./Checkbox-d48cabb4.js";import{_ as Se}from"./_plugin-vue_export-helper-c27b6911.js";function*xe(e,o,l=0,i=null){if(e.length===0)return;i===null&&(i=o.length);let t;for(;(t=o.indexOf(e,l))>-1&&!(t+e.length>i);)yield t,l=t+1}function we(e){return e.split("").reverse().join("")}var ke={searchExact:xe,reverse:we};const{searchExact:D,reverse:Q}=ke;function ze(e,o,l){e.length>o.length&&([e,o]=[o,e]);const i=o.length-e.length;if(i>l)return!1;if(l===0)return e===o;let c;for(c=0;c<e.length&&e[c]===o[c];c++);if(c===e.length)return i<=l;let t;for(t=e.length-1;t>=0&&e[t]===o[t+i];t--);e=e.slice(c,t+1),o=o.slice(c,t+1+i);const[u,v]=L(e,o,l);return u+(o.length-v)<=l}function $e(e,o){e.length>o.length&&([e,o]=[o,e]);const l=new Array(e.length+1);for(let t=0;t<=e.length;t++)l[t]=t;let i,c;for(let t=0;t<o.length;t++){l[0]=t+1,c=t;for(let u=0;u<e.length;u++)i=l[u+1],l[u+1]=Math.min(c+ +(e[u]!==o[t]),l[u]+1,l[u+1]+1),c=i}return l[e.length]}function Ve(e,o){const l={};for(let i=Math.min(e.length-1,o);i>=0;i--)l[e[i]]=i;return l}function*Me(e,o,l){if(e.length>o.length+l)return;const i=Math.floor(e.length/(l+1));if(l===0)for(const c of D(e,o))yield{start:c,end:c+e.length,dist:0};else i>=10?yield*ee(e,o,l):yield*te(e,o,l)}function L(e,o,l){l=+l;let i;for(i=0;i<Math.min(e.length,o.length)&&e.charCodeAt(i)===o.charCodeAt(i);i++);if(i&&(e=e.slice(i),o=o.slice(i)),e){if(!o)return e.length<=l?[e.length,i]:[null,null]}else return[0,i];if(l===0)return[null,null];let c=new Array(e.length+1);for(let r=0;r<=l;r++)c[r]=r;let t=new Array(e.length+1),u=null,v=null,f=l,g=0,m=e.length-1;for(let r=0;r<o.length;r++){const h=o.charCodeAt(r),_=Math.max(0,g-1),b=Math.min(r+l,e.length-1,m);t[0]=c[0]+1,g=t[0]<=f?0:null,m=t[0]<=f?0:-1;let d;for(d=_;d<b;d++){const V=t[d+1]=Math.min(c[d]+ +(h!==e.charCodeAt(d)),c[d+1]+1,t[d]+1);V<=f&&(g===null&&(g=d+1),m=Math.max(m,d+1+(f-V)))}const k=t[d+1]=Math.min(c[d]+ +(h!==e.charCodeAt(d)),t[d]+1);if(k<=f&&(g===null&&(g=d+1),m=d+1),d===e.length-1&&(u===null||k<=u)&&(u=k,v=r,u<f&&(f=u)),[c,t]=[t,c],g===null)break}return u!==null&&u<=l?[u,v+1+i]:[null,null]}function*ee(e,o,l){const i=Math.floor(e.length/(l+1)),c=e.length,t=o.length;for(let u=0;u<=e.length-i;u+=i){const v=e.slice(u,u+i),f=u+i,g=Q(e.slice(0,u)),m=e.slice(f),r=Math.max(0,u-l),h=Math.min(t,t-c+f+l);for(const _ of D(v,o,r,h)){const[b,d]=L(m,o.slice(_+i,_-u+c+l),l);if(b===null)continue;const[k,V]=L(g,Q(o.slice(Math.max(0,_-u-(l-b)),_)),l-b);k!==null&&(yield{start:_-V,end:_+i+d,dist:k+b})}}}function*te(e,o,l){const i=e.length,c=o.length;if(i>c+l)return;const t=Ve(e,l);let u=[],v=[];for(let f=0;f<o.length;f++){const g=o[f];u=v,v=[];const m=t[g];m!==void 0&&(m+1===i?yield{start:f,end:f+1,dist:m}:v.push({startIdx:f,needleIdx:m+1,dist:m}));for(const r of u)if(e[r.needleIdx]===g)r.needleIdx+1===i?yield{start:r.startIdx,end:f+1,dist:r.dist}:v.push({startIdx:r.startIdx,needleIdx:r.needleIdx+1,dist:r.dist});else{if(r.dist===l)continue;v.push({startIdx:r.startIdx,needleIdx:r.needleIdx,dist:r.dist+1});for(let h=1;h<=l-r.dist;h++)if(r.needleIdx+h===i){yield{start:r.startIdx,end:f+1,dist:r.dist+h};break}else if(e[r.needleIdx+h]===g){r.needleIdx+h+1===i?yield{start:r.startIdx,end:f+1,dist:r.dist+h}:v.push({startIdx:r.startIdx,needleIdx:r.needleIdx+1+h,dist:r.dist+h});break}f+1<c&&r.needleIdx+1<i&&v.push({startIdx:r.startIdx,needleIdx:r.needleIdx+1,dist:r.dist+1})}}for(const f of v)f.dist+=e.length-f.needleIdx,f.dist<=l&&(yield{start:f.startIdx,end:o.length,dist:f.dist})}var Ae={_expand:L,editDistance:$e,fuzzySearch:Me,fuzzySearchNgrams:ee,fuzzySearchCandidates:te,isEditDistanceNoGreaterThan:ze};const{editDistance:Ce,fuzzySearch:Ne,isEditDistanceNoGreaterThan:Ee}=Ae;var Fe={editDistance:Ce,fuzzySearch:Ne,isEditDistanceNoGreaterThan:Ee};const Oe="zoa__-kaXq__input",Le="zoa__eVS7Y__label",Pe="zoa__pMc0u__grid",Te="zoa__5cpkc__wrapper",He="zoa__AFCWm__options",Be="zoa__8vnuc__optlist",Ge="zoa__bOurY__listItem",We="zoa__Apoj0__option",je="zoa__MRbwy__selectAll",qe="zoa__m7bV0__subgroup",Ue="zoa__8rcID__noOptions",Ke="zoa__NWh1O__textboxWrapper",Re="zoa__P2F01__arrow",Ze={input:Oe,label:Le,"label--right":"zoa__F-K-n__label--right","label--below":"zoa__v3pp3__label--below","label--above":"zoa__2fKCe__label--above",grid:Pe,"grid--above":"zoa__bnarX__grid--above","grid--below":"zoa__8mlVJ__grid--below","grid--left":"zoa__CQte7__grid--left","grid--right":"zoa__4KDvP__grid--right",wrapper:Te,options:He,optlist:Be,listItem:Ge,option:We,selectAll:je,subgroup:qe,noOptions:Ue,textboxWrapper:Ke,arrow:Re},Ye=["id"],Xe=["for"],Je=["placeholder","id"],Qe=["title"],De=["onClick"],et={key:1},tt=10,le={__name:"Multiselect",props:{modelValue:{type:Array},label:{type:String,default:"Multiselect"},labelPosition:{type:String,default:"above"},delay:{type:Number,default:0},placeholder:{type:[String,void 0],default:null},options:{type:Array},itemName:{type:String,default:"item"},itemNamePlural:{type:[String,null],default:null},searchDelay:{type:Number,default:200},enableSearch:{type:Boolean,default:!1},itemHeight:{type:Number,default:38}},emits:["change","update:modelValue","search"],setup(e,{emit:o}){const l=e,{componentId:i,subId:c}=ge(),{value:t}=ve(o,l);Array.isArray(t)||(t.value=[]);const u=C(null),v=J(n=>{o("search",n)},l.searchDelay),f=J(n=>{u.value=n},l.searchDelay),g=x({get(){return u.value},set(n){f(n),v(n)}}),m=x(()=>(t.value?t.value.length!==1:!0)?l.itemNamePlural||l.itemName+"s":l.itemName),r=x(()=>{let n=[];return l.options.forEach(s=>{typeof s=="object"?n.push({label:s.label||s.value,value:s.value||s.label,group:s.group||null,order:s.order||null}):n.push({label:s,value:s,group:null})}),n.sort((s,a)=>{let p;s.group===a.group?p=0:!s.group||!a.group?p=s.group?1:-1:p=s.group.localeCompare(a.group);let z=0;(s.order||a.order)&&(z=s.order&&a.order?s.order-a.order:s.order?1:-1);let T=s.label.localeCompare(a.label);return p!==0?p:z!==0?z:T}),n}),h=x(()=>{const n=l.enableSearch&&g.value,s=n?g.value.toLowerCase():null,a=I=>I?[...Fe.fuzzySearch(s,I.toLowerCase(),1)].length>0:!1;let p;n?p=r.value.filter(I=>a(I.group)||a(I.label)||a(I.value)):p=r.value;let z=[],T=Object.entries(Object.groupBy(p,({group:I})=>I)),E=s?2:1;return T.forEach(I=>{let A=I[0],Z=I[1];A&&A!=="null"&&(z.push({ix:E,kind:"group",label:A,value:A,group:A}),E+=1),z=z.concat(Z.map((H,ue)=>({ix:E+ue,kind:"option",label:H.label,value:H.value,group:H.group}))),E+=Z.length}),z}),_=C(null),b=C(null),d=C(null),{y:k}=me(d),V=x(()=>!d.value||d.value&&k.value!==d.value.scrollTop?0:k.value),ne=x(()=>{try{return d.value.clientHeight}catch{return 500}}),ae=x(()=>Math.floor(V.value/l.itemHeight)-tt),oe=x(()=>Math.ceil((V.value+ne.value)/l.itemHeight)),M=C(!1),re=be(b),q=ye(d);function U(){M.value=!0,setTimeout(()=>{b.value.focus()},50)}function P(){try{_.value.blur(),b.value.blur(),d.value.blur()}catch{}M.value=!1}function se(){M.value?P():U()}_e(_,()=>{P()}),W("ArrowDown",()=>{if(r.value.length!==0){if(re.focused.value)d.value.children[0].children[0].children[0].focus();else if(q.focused.value){const n=[...d.value.querySelectorAll("label")],s=d.value.querySelector("label:focus");if(!s)n[0].focus();else{const a=n.findIndex(p=>p===s);a===n.length-1?n[0].focus():n[a+1].focus()}}}}),W("ArrowUp",()=>{if(r.value.length!==0&&q.focused.value){const n=[...d.value.querySelectorAll("label")],s=d.value.querySelector("label:focus");if(!s)b.value.focus();else{const a=n.findIndex(p=>p===s);a===0?b.value.focus():n[a-1].focus()}}}),W("Enter",()=>{P()});const K=x({get(){const n=r.value;return t.value.length!==n.length?!1:n.filter(a=>!t.value.includes(a.value)).length===0},set(n){n?t.value=r.value.map(s=>s.value):t.value=[]}}),R=x({get(){let n=h.value.filter(a=>a.kind==="option").map(a=>a.value);return t.value.length<n.length?!1:n.filter(a=>!t.value.includes(a)).length===0},set(n){let s=h.value.filter(a=>a.kind==="option").map(a=>a.value);if(n){const a=s.filter(p=>!t.value.includes(p));t.value=t.value.concat(a)}else t.value=t.value.filter(a=>!s.includes(a))}});function ie(n){const s=h.value.filter(p=>p.kind==="option"&&p.group===n).map(p=>p.value),a=s.filter(p=>!t.value.includes(p));a.length>0?a.forEach(p=>{t.value.push(p)}):t.value=t.value.filter(p=>!s.includes(p))}return(n,s)=>(S(),w("div",{class:y([n.$style.grid,n.$style[`grid--${e.labelPosition}`]]),id:$(i)},[e.label&&e.labelPosition!=="none"?(S(),w("label",{key:0,for:$(c)("textbox"),class:y([n.$style.label,n.$style[`label--${e.labelPosition}`]])},F(e.label),11,Xe)):O("",!0),N("div",{class:y(n.$style.wrapper),ref_key:"container",ref:_},[N("div",{class:y(n.$style.textboxWrapper)},[Y(N("input",{type:"text",placeholder:e.placeholder,id:$(c)("search"),class:y(n.$style.input),"onUpdate:modelValue":s[0]||(s[0]=a=>g.value=a),ref_key:"textbox",ref:b},null,10,Je),[[ce,g.value],[X,M.value]]),Y(N("div",{class:y(n.$style.input),tabindex:"0",onFocusin:U},F($(t)?$(t).length:0)+" "+F(m.value)+" selected ",35),[[X,!M.value]]),B($(Ie),{icon:"fa-solid fa-caret-down",class:y(n.$style.arrow),onClick:se},null,8,["class"])],2),M.value?(S(),w("div",{key:0,class:y(n.$style.options),ref_key:"dropdown",ref:d},[r.value.length>0?(S(),w("ul",{key:0,class:y(n.$style.optlist)},[N("li",{title:"Select all",class:y([n.$style.selectAll,n.$style.listItem,n.$style.option]),style:G({height:`${e.itemHeight}px`})},[B(j,{label:"Select all","label-position":"right",modelValue:K.value,"onUpdate:modelValue":s[1]||(s[1]=a=>K.value=a)},null,8,["modelValue"])],6),u.value?(S(),w("li",{key:0,title:"Select results",class:y([n.$style.selectAll,n.$style.listItem,n.$style.option]),style:G({height:`${e.itemHeight}px`})},[B(j,{label:"Select results","label-position":"right",modelValue:R.value,"onUpdate:modelValue":s[2]||(s[2]=a=>R.value=a)},null,8,["modelValue"])],6)):O("",!0),(S(!0),w(de,null,fe(h.value,a=>(S(),w("li",{title:a.label,class:y([n.$style.listItem,a.kind==="group"?n.$style.subgroup:n.$style.option]),style:G({height:`${e.itemHeight}px`})},[a.kind==="group"?(S(),w("div",{key:0,onClick:p=>ie(a.group)},F(a.label),9,De)):(S(),w("div",et,[a.ix>=ae.value&&a.ix<=oe.value?(S(),pe(j,{key:0,label:a.label,"label-position":"right","check-value":a.value,name:$(c)("checkboxes"),modelValue:$(t),"onUpdate:modelValue":s[3]||(s[3]=p=>he(t)?t.value=p:null)},null,8,["label","check-value","name","modelValue"])):O("",!0)]))],14,Qe))),256))],2)):(S(),w("div",{key:1,class:y(n.$style.noOptions)},"No options found",2))],2)):O("",!0)],2)],10,Ye))}},lt={$style:Ze},ut=Se(le,[["__cssModules",lt]]);le.__docgenInfo={exportName:"default",displayName:"Multiselect",description:"",tags:{},props:[{name:"v-model",tags:{model:[{description:!0,title:"model"}]},type:{name:"array"}},{name:"label",description:"Text for the input label.",type:{name:"string"},defaultValue:{func:!1,value:"'Multiselect'"}},{name:"labelPosition",description:"Position of the input label (or none).",tags:{},values:["left","right","above","below","none"],type:{name:"string"},defaultValue:{func:!1,value:"'above'"}},{name:"delay",description:"Debounce delay for the `change` event, in ms.",type:{name:"number"},defaultValue:{func:!1,value:"0"}},{name:"placeholder",description:"Text to display in the blank input.",type:{name:"string|undefined"},defaultValue:{func:!1,value:"null"}},{name:"options",description:"The options available to select. Each item can be a string, or an object with `label` and `value` keys.",type:{name:"array"}},{name:"itemName",description:'The string used to describe the items being selected, in singular form e.g. "resource", "genus".',type:{name:"string"},defaultValue:{func:!1,value:"'item'"}},{name:"itemNamePlural",description:'The plural form of itemName, e.g. "resources", "genera". If null (default), an "s" will be added to itemName.',type:{name:"string|null"},defaultValue:{func:!1,value:"null"}},{name:"searchDelay",description:"Debounce delay for the `search` event, in ms.",type:{name:"number"},defaultValue:{func:!1,value:"200"}},{name:"enableSearch",description:"Enables an internal list filtering based on the search value. Disable if implementing an external filter using the emit.",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"itemHeight",description:"Override the height (in px) of each list item. May be necessary if font family or size is changed from the default.",type:{name:"number"},defaultValue:{func:!1,value:"38"}}],events:[{name:"change",description:"Emitted when the value changes; debounced if the delay prop is > 0.",properties:[{type:{names:["string"]},name:"newValue",description:"the new value"}],tags:[{title:"arg",type:{name:"string"},name:"newValue",description:"the new value"}]},{name:"update:modelValue",tags:[{title:"ignore",content:!0}]},{name:"search",description:"Emitted when the search value changes; debounced if the searchDelay prop is > 0.",properties:[{type:{names:["string"]},name:"searchTerm",description:"the search term"}],tags:[{title:"arg",type:{name:"string"},name:"searchTerm",description:"the search term"}]}],sourceFiles:["/home/runner/work/zoa/zoa/src/components/inputs/dropdown/Multiselect.vue"]};export{ut as Z};
//# sourceMappingURL=Multiselect-8bd7a645.js.map
