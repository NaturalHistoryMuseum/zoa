{"version":3,"file":"Slider-2420a819.js","sources":["../../src/components/inputs/slider/slider.js","../../src/components/inputs/slider/Slider.vue"],"sourcesContent":["// common functions for the sliders\n\nexport function getFraction(value, props) {\n  return (value - props.min) / (props.max - props.min);\n}\n\nexport function getHandlePosition(slider, fraction, label) {\n  // the center of the slider is slightly offset to account for the size of the\n  // handle. this calculates the position of the middle of the handle along the\n  // track, accounting for the offset.\n  try {\n    const trackWidth = slider.clientWidth;\n    const handleWidth = 24; // set in CSS; including border!\n\n    const labelWidth = label ? label.clientWidth : 0;\n\n    const halfTrack = trackWidth / 2;\n    const currentPosition = fraction * trackWidth;\n    const centerOffset = (currentPosition - halfTrack) / halfTrack;\n    const offset = centerOffset * (handleWidth / 2);\n    const labelOffset = offset + labelWidth / 2;\n    const percentOffset = offset / trackWidth;\n    return {\n      handle: ((fraction - percentOffset) * 100).toFixed(2),\n      label: ((fraction - labelOffset / trackWidth) * 100).toFixed(2),\n    };\n  } catch {\n    // in case we can't get the clientWidth\n    const pos = fraction * 100;\n    return { handle: pos.toFixed(2), label: pos.toFixed(2) };\n  }\n}\n\nexport function getInitialValue(\n  min,\n  max,\n  step,\n  placeholder = null,\n  position = 0.5,\n) {\n  if (placeholder) {\n    return placeholder;\n  }\n  let range = max - min;\n  let exactMidpoint = range / (1 / position);\n  let stepDeviation = exactMidpoint % step;\n  let stepMidpoint = exactMidpoint - stepDeviation;\n  return stepMidpoint + min;\n}\n","<template>\n  <div\n    :class=\"[\n      $style.grid,\n      $style[`grid--${labelPosition}`],\n      $style[`wrapper--value-label-${valueLabelPosition}`],\n    ]\"\n    :id=\"componentId\"\n  >\n    <label\n      v-if=\"label && labelPosition !== 'none'\"\n      :class=\"[$style.label, $style[`label--${labelPosition}`]]\"\n      :for=\"subId('slider')\"\n    >\n      {{ label }}\n    </label>\n    <div :class=\"$style.slider\" @wheel=\"onScroll\">\n      <span :class=\"$style.track\"></span>\n      <span\n        :class=\"[$style.track, $style['track--active']]\"\n        :style=\"activeTrackStyle\"\n      ></span>\n      <span\n        :class=\"[\n          $style.valueLabel,\n          $style[`valueLabel--${valueLabelPosition}`],\n        ]\"\n        :style=\"{ left: `${handlePosition.label}%` }\"\n        ref=\"valueLabel\"\n        tabindex=\"0\"\n        >{{ valueLabelText }}</span\n      >\n      <input\n        type=\"range\"\n        :min=\"min\"\n        :max=\"max\"\n        :step=\"step\"\n        :id=\"subId('slider')\"\n        :class=\"$style.input\"\n        v-model=\"value\"\n        ref=\"slider\"\n      />\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { useComponentId } from '../../utils/compid.js';\nimport { useChangeEmits } from '../common.js';\nimport { computed, ref, watch } from 'vue';\nimport { getFraction, getHandlePosition, getInitialValue } from './slider.js';\nimport { onKeyStroke, useFocusWithin, useFocus } from '@vueuse/core';\n\nconst props = defineProps({\n  modelValue: {},\n  labelPosition: {\n    type: String,\n    default: 'above',\n  },\n  label: {\n    type: String,\n    default: 'Slider',\n  },\n  delay: {\n    type: Number,\n    default: 200,\n  },\n  placeholder: {\n    type: Number,\n    default: 0,\n  },\n  placeholderPosition: {\n    type: Number,\n    default: 0.5,\n  },\n  min: {\n    type: Number,\n    default: 0,\n  },\n  max: {\n    type: Number,\n    default: 100,\n  },\n  step: {\n    type: Number,\n    default: 1,\n  },\n  valueLabelPosition: {\n    type: String,\n    default: 'below',\n  },\n  validMin: {\n    type: Number,\n    default: null,\n  },\n  validMax: {\n    type: Number,\n    default: null,\n  },\n  activeTrackRight: {\n    type: Boolean,\n    default: false,\n  },\n});\n\nconst { componentId, subId } = useComponentId();\n\nconst emit = defineEmits(['change', 'update:modelValue']);\nconst { value } = useChangeEmits(emit, props);\n\n// REFS\nconst slider = ref(null);\nconst valueLabel = ref(null);\n\n// PROP PROCESSING\nconst _validMin = computed(() => {\n  // set validMin to the min if not set\n  if (!props.validMin) {\n    return Number(props.min);\n  }\n  return Math.max(Number(props.validMin), Number(props.min));\n});\nconst _validMax = computed(() => {\n  // set validMax to the max if not set\n  if (!props.validMax) {\n    return Number(props.max);\n  }\n  return Math.min(Number(props.validMax), Number(props.max));\n});\n\n// STATE\nconst sliderFocus = useFocusWithin(slider);\nconst labelFocus = useFocus(valueLabel);\n\nconst valueLabelText = computed(() => {\n  // prevents the label flickering when trying to move it beyond its bounds\n  if (value.value < _validMin.value) {\n    return _validMin.value;\n  } else if (value.value > _validMax.value) {\n    return _validMax.value;\n  } else {\n    return value.value;\n  }\n});\n\nconst activeTrackStyle = computed(() => {\n  if (props.activeTrackRight) {\n    return { left: `${handlePosition.value.handle}%` };\n  } else {\n    return { right: `${100 - handlePosition.value.handle}%` };\n  }\n});\n\nconst fraction = computed(() => {\n  return getFraction(value.value, props);\n});\n\nconst handlePosition = computed(() => {\n  return getHandlePosition(slider.value, fraction.value, valueLabel.value);\n});\n\n// FUNCTIONS\nfunction stepUp() {\n  if (value.value === props.max) {\n    return;\n  }\n  let newValue = Number(value.value) + Number(props.step);\n  if (newValue > props.max) {\n    value.value = props.max;\n  } else {\n    value.value = newValue;\n  }\n}\n\nfunction stepDown() {\n  if (value.value === props.min) {\n    return;\n  }\n  let newValue = Number(value.value) - Number(props.step);\n  if (newValue < props.min) {\n    value.value = props.min;\n  } else {\n    value.value = newValue;\n  }\n}\n\nfunction onScroll(event) {\n  event.preventDefault();\n  if (event.wheelDelta > 0) {\n    stepUp();\n  } else if (event.wheelDelta < 0) {\n    stepDown();\n  }\n}\n\n// KEYBINDINGS\nonKeyStroke('ArrowDown', (event) => {\n  event.preventDefault();\n  if (sliderFocus.focused.value || labelFocus.focused.value) {\n    stepDown();\n  }\n});\nonKeyStroke('ArrowLeft', (event) => {\n  event.preventDefault();\n  if (sliderFocus.focused.value || labelFocus.focused.value) {\n    stepDown();\n  }\n});\nonKeyStroke('ArrowUp', (event) => {\n  event.preventDefault();\n  if (sliderFocus.focused.value || labelFocus.focused.value) {\n    stepUp();\n  }\n});\nonKeyStroke('ArrowRight', (event) => {\n  event.preventDefault();\n  if (sliderFocus.focused.value || labelFocus.focused.value) {\n    stepUp();\n  }\n});\n\n// WATCHES\nwatch(value, (newValue) => {\n  // don't let the value exceed the valid min/max\n  if (Number(newValue) >= Number(_validMax.value)) {\n    value.value = _validMax.value;\n  }\n  if (Number(newValue) <= Number(_validMin.value)) {\n    value.value = _validMin.value;\n  }\n});\n\n// set an initial value\nvalue.value = getInitialValue(\n  props.min,\n  props.max,\n  props.step,\n  props.placeholder,\n  props.placeholderPosition,\n);\n</script>\n\n<style module lang=\"scss\">\n@import '../inputs';\n\n$handleSize: 20px;\n$handleBorder: 2px;\n\n.wrapper--value-label-below {\n  margin-bottom: 35px;\n}\n\n.wrapper--value-label-above {\n  margin-top: 35px;\n}\n\n.input {\n  appearance: none;\n  -webkit-appearance: none;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n  background: transparent;\n  border: none;\n  outline: 0;\n  padding: 0;\n  margin: 0;\n  position: absolute;\n\n  &::-webkit-slider-thumb,\n  &::-moz-range-thumb {\n    appearance: none;\n    -webkit-appearance: none;\n    width: $handleSize;\n    height: $handleSize;\n    background: $primary;\n    cursor: pointer;\n    border-radius: 100%;\n    z-index: 100;\n    border: $handleBorder solid $grey;\n  }\n}\n\n.slider {\n  position: relative;\n  height: $handleSize + ($handleBorder * 2);\n}\n\n.track {\n  position: absolute;\n  height: 10px;\n  margin: auto;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  border-radius: $rounding;\n  background: $grey;\n\n  &.track--active {\n    background: $secondary;\n  }\n}\n\n.valueLabel {\n  position: absolute;\n  font-size: 0.8em;\n  padding: $half-pad;\n  border: 1px solid $grey;\n  border-radius: $rounding;\n  background: white;\n  height: 30px;\n\n  &.valueLabel--below {\n    top: $handleSize + ($handleBorder * 2) + 5px;\n  }\n\n  &.valueLabel--above {\n    bottom: $handleSize + ($handleBorder * 2) + 5px;\n  }\n}\n</style>\n"],"names":["getFraction","value","props","getHandlePosition","slider","fraction","label","trackWidth","handleWidth","labelWidth","halfTrack","offset","labelOffset","percentOffset","pos","getInitialValue","min","max","step","placeholder","position","exactMidpoint","stepDeviation","componentId","subId","useComponentId","useChangeEmits","emit","ref","valueLabel","_validMin","computed","_validMax","sliderFocus","useFocusWithin","labelFocus","useFocus","valueLabelText","activeTrackStyle","handlePosition","stepUp","newValue","stepDown","onScroll","event","onKeyStroke","watch"],"mappings":"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"}